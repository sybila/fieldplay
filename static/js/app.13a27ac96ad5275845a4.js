webpackJsonp([4],{"/eR5":function(e,n,t){"use strict";function r(e){function n(n,o){var a=t.i(i.a)(e,o);r.bindInput(n,a)}var r=t.i(o.a)();return e.inputs=r,{setBinding:n}}n.a=r;var o=t("n67P"),i=(t("p2DF"),t("I6d+"))},"2PgA":function(e,n,t){function r(e,n){function t(){var e=Object.create(null),n=window.location.search;n&&(e=Object.assign(e,i.parse(n.substr(1))));var t=window.location.hash;t&&(e=Object.assign(e,i.parse(t.substr(2)))),r(e)}function r(e){var n=p+i.stringify(e);window.history?window.history.replaceState(void 0,void 0,n):window.location.replace(n)}function a(e){if("function"!=typeof e)throw new Error("changeCallback needs to be a function");0===d.length&&window.addEventListener("hashchange",c,!1),d.push(e)}function u(){0!==d.length&&(d=[],window.removeEventListener("hashchange",c,!1))}function c(){s(f())}function s(e){for(var n=0;n<d.length;++n){(0,d[n])(e)}}function f(){var e=l?window.location.search:window.location.hash,n=(e||p).substr(p.length);return i.parse(n)}if("undefined"==typeof window)return o(e);var d=[],l=n&&n.useSearch,p=l?"?":"#?";return n.rewriteHashToSearch&&t(),function(){var n=f(),t=!1;"object"==typeof e&&e&&Object.keys(e).forEach(function(r){r in n||(n[r]=e[r],t=!0)}),t&&r(n)}(),{onChanged:a,dispose:u,set:r,get:f,rewriteHashToSearch:t}}e.exports=r;var o=t("5hi0"),i=t("9XuS")},"3xg8":function(e,n,t){"use strict";function r(e){function n(n){v.setCustomVectorField(n);var t=v.getFragmentShader(),r=v.getVertexShader(),o=i.a.createProgram(y,r,t);_&&_.unload(),_=o,e.colorMode===u.a.VELOCITY&&E.requestSpeedUpdate()}function r(n,r){h=e.particleStateResolution;var o=[{name:"x",particleState:n},{name:"y",particleState:r}];g&&g.dispose(),g=t.i(s.a)(y,o,h),x&&x.dispose(),x=t.i(s.a)(y,o,h),E.updateParticlesCount()}function a(n){var t=e.colorMode;t===u.a.UNIFORM?y.uniform4f(n.u_particle_color,w.r,w.g,w.b,w.a):t===u.a.VELOCITY&&E.setColorMinMax(n),g.bindTextures(y,n)}function d(){var n=_;y.useProgram(n.program),i.a.bindAttribute(y,e.quadBuffer,n.a_pos,2),e.inputs.updateBindings(n),e.audioTexture&&(i.a.bindTexture(y,e.audioTexture,5),y.uniform1i(n.u_audio,5)),g.bindTextures(y,n),y.uniform1f(n.u_rand_seed,e.frameSeed),y.uniform1f(n.u_h,e.integrationTimeStep),y.uniform1f(n.frame,e.frame);var t=e.cursor;y.uniform4f(n.cursor,t.clickX,t.clickY,t.hoverX,t.hoverY);var r=e.bbox;y.uniform2f(n.u_min,r.minX,r.minY),y.uniform2f(n.u_max,r.maxX,r.maxY),y.uniform1f(n.u_drop_rate,e.dropProbability);for(var o=0;o<x.length;++o){var a=x.get(o);y.uniform1i(n.u_out_coordinate,o),i.a.bindFramebuffer(y,e.framebuffer,a.texture),y.viewport(0,0,h,h),y.drawArrays(y.TRIANGLES,0,6)}e.colorMode===u.a.VELOCITY&&E.updateParticlesPositions(n),b&&(m(n),b=null);var c=g;g=x,x=c}function l(e){b=e}function m(n){var r=[{name:"x",particleState:b.x},{name:"y",particleState:b.y}],a=b.resolution,u=a*a,c=t.i(s.a)(y,r,a),d=t.i(s.a)(y,r,a);c.bindTextures(y,n);var l=d.get(0);y.uniform1i(n.u_out_coordinate,6),i.a.bindFramebuffer(y,e.framebuffer,l.texture),y.viewport(0,0,a,a),y.drawArrays(y.TRIANGLES,0,6);var v=new Uint8Array(4*u);y.readPixels(0,0,a,a,y.RGBA,y.UNSIGNED_BYTE,v),y.uniform1i(n.u_out_coordinate,7),l=d.get(1),i.a.bindFramebuffer(y,e.framebuffer,l.texture),y.viewport(0,0,a,a),y.drawArrays(y.TRIANGLES,0,6);var m=new Uint8Array(4*u);y.readPixels(0,0,a,a,y.RGBA,y.UNSIGNED_BYTE,m),d.dispose(),c.dispose();for(var g=t.i(f.a)(),x=t.i(f.a)(),h=new Float32Array(u),_=new Float32Array(u),w=0;w<m.length;w+=4){var E=w/4,T=o(v,w),P=o(m,w);h[E]=T,_[E]=P,g.add(T),x.add(P)}var A={xStats:g,yStats:x,decoded_velocity_x:h,decoded_velocity_y:_,resolution:a};p.a.fire("vector-line-ready",A)}var g,x,h,_,b,y=e.gl,w={r:77/255,g:188/255,b:201/255,a:1},E=t.i(c.a)(e);return p.a.on("vector-lines-request",l),{updateCode:n,updateParticlesPositions:d,updateParticlesCount:r,prepareToDraw:a}}function o(e,n){return t.i(d.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var i=t("Ddjs"),a=t("Qv35"),u=t("6c6E"),c=t("gIFv"),s=t("pXNl"),f=t("V39N"),d=t("FaU1"),l=t("eBcr"),p=t.n(l),v=new a.a},"4KA4":function(e,n,t){"use strict";var r=t("Zrlr"),o=t.n(r),i=t("wxAW"),a=t.n(i),u=function(){function e(){o()(this,e)}return a()(e,[{key:"getDefines",value:function(){return""}},{key:"getFunctions",value:function(){return""}},{key:"getMainBody",value:function(){return""}}]),e}();n.a=u},"5hi0":function(e,n){function t(e){function n(){return u}function t(e){u=e,setTimeout(function(){i(e)},0)}function r(){a=[]}function o(e){if("function"!=typeof e)throw new Error("changeCallback should be a function");a.push(e)}function i(e){a.forEach(function(n){n(e)})}var a=[],u=e;return{dispose:r,onChanged:o,set:t,get:n}}e.exports=t},"6c6E":function(e,n,t){"use strict";n.a={UNIFORM:1,VELOCITY:2,ANGLE:3}},"7UaU":function(e,n,t){function r(e,n){function t(e,n){g.on("change",e,n)}function r(e,n){g.off("change",e,n)}function o(){return p}function c(){p.dispose(),g.off()}function s(e){return void 0===e?v:v[e]}function f(e,n){var t=typeof e;return"object"===t?Object.keys(e).forEach(function(n){v[n]=e[n]}):"string"===t&&(v[e]=n),p.set(v),m}function d(e){v=e,g.fire("change",v)}function l(e,n){if("object"==typeof e&&Object.keys(e).forEach(function(n){n in v||(v[n]=e[n])}),!(e in v))return v[e]=n,p.set(v),m}n=n||{};var p=n.history||u(e,n);i(p),p.onChanged(d);var v=p.get()||Object.create(null),m={get:s,set:f,setIfEmpty:l,dispose:c,onChange:t,offChange:r,getHistoryObject:o},g=a({});return m}function o(e){return c?e&&c.setIfEmpty(e):c=r(e),c}function i(e){if(!e)throw new Error("history is required");if("function"!=typeof e.dispose)throw new Error("dispose is required");if("function"!=typeof e.onChanged)throw new Error("onChanged is required")}e.exports=r;var a=t("fkI9"),u=t("2PgA");r.instance=o;var c},"85ps":function(e,n,t){"use strict";function r(e){return t.i(s.a)(e).then(function(n){if(n.error)return n;e=n.getCode();var t=f.check(e,{globals:d});return t.code=e,t.log.errorCount&&(t.error=o(t.log)),t})}function o(e){var n=e.diagnostics[0],t=n.range,r=t.lineColumn(),o=t.source,u=o._lineOffsets[r.line],c=o.contents.substr(u,r.column);c+=o.contents.substring(t.start,t.end);var s="Line "+r.line+": ",f=n.text;return{error:s+c+"\n"+a(s.length)+a(r.column)+"^",errorDetail:f,isFloatError:i(f)}}function i(e){return e.indexOf('"int"')>-1&&e.indexOf('"float"')>-1}function a(e){return new Array(e+1).join(" ")}n.a=r;var u=t("eBcr"),c=t.n(u),s=t("svlg"),f={check:function(e){return{code:e,log:{errorCount:0}}}};t.e(2).then(function(){f=t("TFw8"),c.a.fire("glsl-parser-ready")}.bind(null,t)).catch(t.oe);var d="\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  sampler2D input0;\n  sampler2D input1;\n}"},"94y8":function(e,n,t){"use strict";function r(e){function n(){i.a.off("audio",r),o.deleteTexture(c)}function t(){if(s){s=!1;o.bindTexture(o.TEXTURE_2D,c),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,5,5,0,o.RGBA,o.UNSIGNED_BYTE,u),o.bindTexture(o.TEXTURE_2D,null)}}function r(e){u=e,s=!0}var o=e.gl,u=new Uint8Array(256),c=a.a.createTexture(o,o.NEAREST,u,8,8),s=!1;return e.audioTexture=c,i.a.on("audio",r),{updateTextures:t,dispose:n}}var o=t("eBcr"),i=t.n(o),a=t("Ddjs");n.a=r},"9XuS":function(e,n){function t(e){function n(n){var t=e[n],r=i(n);return void 0!==t&&(r+="="+o(t)),r}return e?Object.keys(e).map(n).join("&"):""}function r(e){function n(e){if(e){var n=e.split("=");t[decodeURIComponent(n[0])]=u(n[1])}}var t=Object.create(null);return e?(e.split("&").forEach(n),t):t}function o(e){return e instanceof Date&&(e=e.toISOString()),i(e)}function i(e){return encodeURIComponent(e).replace(/[()]/g,a)}function a(e){return")"===e?"%29":"("===e?"%28":e}function u(e){return e=decodeURIComponent(e),""===e?e:isNaN(e)?c(e)?"true"===e:s(e)?new Date(e):e:parseFloat(e)}function c(e){return"true"===e||"false"===e}function s(e){return e&&e.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/)}e.exports={parse:r,stringify:t}},C8nW:function(e,n,t){"use strict";function r(e,n){function t(t,r){function o(e){e.lengthComputable&&n.progress({loaded:e.loaded,total:e.total,percent:e.loaded/e.total})}function i(){if(200!==c.status)return void r("Unexpected status code "+c.status+" when calling "+e);var o=c.response;"json"===n.responseType&&"string"==typeof o&&(o=JSON.parse(o)),t(o)}function a(){r("Failed to download "+e)}function u(){r("Cancelled download of "+e)}var c=new XMLHttpRequest;"function"==typeof n.progress&&c.addEventListener("progress",o,!1),c.addEventListener("load",i,!1),c.addEventListener("error",a,!1),c.addEventListener("abort",u,!1),c.open("GET",e),n.responseType&&(c.responseType=n.responseType),c.send(null)}return n||(n={}),new i.a(t)}n.a=r;var o=t("//Fk"),i=t.n(o)},Ddjs:function(e,n,t){"use strict";function r(e,n,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n)}function o(e,n){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),t}function i(e,n,t,r,o){var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),t instanceof Uint8Array?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,o,0,e.RGBA,e.UNSIGNED_BYTE,t):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),i}function a(e,n,t){e.bindFramebuffer(e.FRAMEBUFFER,n),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}function u(e,n,t,r){e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r,e.FLOAT,!1,0,0)}function c(e,n,t){function r(){e.deleteProgram(o)}var o=e.createProgram(),i=s(e,e.VERTEX_SHADER,n),a=s(e,e.FRAGMENT_SHADER,t);if(e.attachShader(o,i),e.attachShader(o,a),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(o));var u,c={program:o,unload:r},f=e.getProgramParameter(o,e.ACTIVE_ATTRIBUTES);for(u=0;u<f;u++){var d=e.getActiveAttrib(o,u);c[d.name]=e.getAttribLocation(o,d.name)}var l=e.getProgramParameter(o,e.ACTIVE_UNIFORMS);for(u=0;u<l;u++){var p=e.getActiveUniform(o,u);c[p.name]=e.getUniformLocation(o,p.name)}return c}function s(e,n,t){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r}n.a={createTexture:i,bindFramebuffer:a,createProgram:c,createBuffer:o,bindAttribute:u,bindTexture:r}},DuZ1:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),u=t("wxAW"),c=t.n(u),s=t("zwoO"),f=t.n(s),d=t("Pf15"),l=t.n(d),p=t("4KA4"),v=t("JjDM"),m=t("bvb0"),g=function(e){function n(e){a()(this,n);var t=f()(this,(n.__proto__||o()(n)).call(this));return t.updateCode=e||"",t}return l()(n,e),c()(n,[{key:"setNewUpdateCode",value:function(e){this.updateCode=e}},{key:"getDefines",value:function(){return"\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\n#define PI 3.1415926535897932384626433832795\n\n"+t.i(m.a)()+"\n"}},{key:"getFunctions",value:function(){return"\n"+v.a+"\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n"+(this.updateCode?this.updateCode:"vec2 get_velocity(vec2 p) { return vec2(0.); }")+"\n  "}}]),n}(p.a);n.a=g},FaU1:function(e,n,t){"use strict";function r(e,n,t){if(0==e)return n[t+0]=0,n[t+1]=0,n[t+2]=0,void(n[t+3]=0);var r=Math.abs(e),o=Math.floor(u()(r));o+=i(o)<=r/2?1:0,o-=i(o)>r?1:0;var a;a=o>100?r/1024/i(o-10)-1:r/i(o)-1;var c=o+127;a*=256;var s=Math.floor(a);a-=s,a*=256;var f=Math.floor(a);a-=f,a*=128;var d=2*Math.floor(a)+(e<0?1:0);n[t+0]=c,n[t+1]=s,n[t+2]=f,n[t+3]=d}function o(e,n,t,r){var o=Math.floor(e+.5),a=Math.floor(n+.5),u=Math.floor(t+.5),c=Math.floor(r+.5),s=o-127;return(1-c%2*2)*((o>0?1:0)+a/256+u/65536+Math.floor(c/2)/8388608)*i(s)}function i(e){return Math.exp(e*Math.LN2)}n.a=r,n.b=o;var a=t("yI0F"),u=t.n(a)},"I6d+":function(e,n,t){"use strict";function r(e,n){function r(n,t){var r=t+u;i.a.bindTexture(e.gl,a,r),e.gl.uniform1i(n["input"+t],r)}var a=t.i(o.a)(e.gl,n);return{updateBinding:r,dispose:function(){e.gl.deleteTexture(a)}}}n.a=r;var o=t("egvE"),i=t("Ddjs"),a=t("rvz5"),u=a.a.FREE_TEXTURE_UNIT},JHsM:function(e,n,t){"use strict";function r(e){function n(e){if(e){var n=s()({},q.bbox);if(r(e,"minX",n),r(e,"minY",n),r(e,"maxX",n),r(e,"maxY",n),void 0!==e.minY||void 0!==e.maxY){var t=Math.abs(n.minY-n.maxY)/Math.abs(q.bbox.minY-q.bbox.maxY),o=(q.bbox.maxX+q.bbox.minX)/2,i=(q.bbox.maxX-q.bbox.minX)/2;n.minX=o-i*t,n.maxX=o+i*t}L(n)}}function r(e,n,t){var r=u()(e[n]);i()(r)&&(t[n]=r)}function o(e){j=e}function a(){j=null}function c(e){var n=parseInt(e,10);m.a.setColorMode(n),q.colorMode=m.a.getColorMode(),Q.updateColorMode(n)}function d(){return m.a.getColorMode()}function p(){return m.a.getIntegrationTimeStep()}function w(e){var n=parseFloat(e);i()(n)&&(q.integrationTimeStep=n,m.a.setIntegrationTimeStep(n),v.a.fire("integration-timestep-changed",n))}function E(e){H=e,I()}function T(e){var n=parseFloat(e);i()(n)&&(q.fadeOpacity=n,m.a.setFadeout(n))}function P(){return m.a.getFadeout()}function A(){return m.a.getParticleCount()}function R(e){i()(e)&&e!==W&&(e<1||(N(e),W=e,m.a.setParticleCount(e)))}function C(e){var n=parseFloat(e);i()(n)&&(m.a.setDropProbability(n),q.dropProbability=n)}function M(){return m.a.getDropProbability()}function F(){D(window.innerWidth,window.innerHeight),J.updateScreenTextures(),O(V)}function D(n,t){var r=Math.max(.02*n,30),o=Math.max(.02*t,30);G.width=n+2*r,G.height=t+2*o,G.top=-o,G.left=-r;var i=e.canvas;i.width=G.width,i.height=G.height,i.style.left=-r+"px",i.style.top=-o+"px"}function S(){X(),te.dispose(),window.removeEventListener("resize",F,!0),$.dispose(),ee.dispose()}function I(){Z||H||(Z=requestAnimationFrame(B))}function X(){cancelAnimationFrame(Z),Z=0}function B(){Z=0,U(),j&&j.capture(e.canvas),I()}function U(){J.fadeOutLastFrame(),Q.drawParticles(),J.renderCurrentScreen(),Q.updateParticlesPositions()}function N(e){q.particleStateResolution=Math.ceil(Math.sqrt(e)),Q.updateParticlesCount()}function Y(){var e=m.a.getBBox(),n=G.width,t=G.height,r=Math.PI*Math.E,o=Math.PI*Math.E,i=0,a=0;e&&(r=e.maxX-e.minX,o=e.maxY-e.minY,i=n*(e.minX+e.maxX)/2,a=n*(e.minY+e.maxY)/2);var u=r*n/2,c=o*t/2;te.showRectangle({left:-u+i,top:-c-a,right:u+i,bottom:c-a})}function O(e){function n(n){return(n-e.x)/e.scale}function t(n){return(n-e.y)/e.scale}J.boundingBoxUpdated=!0,V.x=e.x,V.y=e.y,V.scale=e.scale;var r=G.width,o=G.height,i=n(0),a=t(0),u=n(r),c=t(o),s=1e4;z.minX=Math.round(s*i/r)/s,z.minY=Math.round(s*-a/r)/s,z.maxX=Math.round(s*u/r)/s,z.maxY=Math.round(s*-c/r)/s,m.a.saveBBox(z),v.a.fire("bbox-change",z)}function k(){var e=Math.PI*Math.E*.5,n=Math.PI*Math.E*.5;L({minX:-e,minY:-n,maxX:e,maxY:n})}function L(e){m.a.saveBBox(e,!0),Y(),te.moveBy(0,0,!1)}var G={width:0,height:0,top:0,left:0};D(e.canvas.width,e.canvas.height),window.addEventListener("resize",F,!0),v.a.on("start-record",o),v.a.on("stop-record",a);var j=null,z=m.a.getBBox()||{},V={scale:1,x:0,y:0},W=m.a.getParticleCount();e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST);var Z,q={gl:e,bbox:z,canvasRect:G,inputs:null,framebuffer:e.createFramebuffer(),quadBuffer:f.a.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),colorMode:m.a.getColorMode(),screenTextureUnit:3,integrationTimeStep:m.a.getIntegrationTimeStep(),dropProbability:m.a.getDropProbability(),frame:0,cursor:{clickX:0,clickY:0,hoverX:0,hoverY:0},particleStateResolution:0,fadeOpacity:m.a.getFadeout(),audioTexture:null},H=!1,K=t.i(y.a)(q),J=t.i(x.a)(q),Q=t.i(h.a)(q),$=t.i(_.a)(q),ee=t.i(b.a)(Q);N(W);var ne={start:I,stop:X,dispose:S,resetBoundingBox:k,moveBoundingBox:n,setPaused:E,getParticlesCount:A,setParticlesCount:R,setFadeOutSpeed:T,getFadeOutSpeed:P,setDropProbability:C,getDropProbability:M,getIntegrationTimeStep:p,setIntegrationTimeStep:w,setColorMode:c,getColorMode:d,vectorFieldEditorState:ee,inputsModel:K,getCanvasRect:function(){return G},getBoundingBox:function(){return q.bbox}},te=function(){return l()(e.canvas,{realPinch:!0,zoomSpeed:.025,controller:t.i(g.a)(e.canvas,O)})}();return Y(),setTimeout(function(){v.a.fire("scene-ready",ne)}),ne}n.a=r;var o=t("AMV0"),i=t.n(o),a=t("5dBV"),u=t.n(a),c=t("woOf"),s=t.n(c),f=t("Ddjs"),d=t("yBIK"),l=t.n(d),p=t("eBcr"),v=t.n(p),m=t("NEgR"),g=t("p0IO"),x=t("h62Y"),h=t("pKWO"),_=t("p9aJ"),b=t("c5hq"),y=t("/eR5")},JjDM:function(e,n,t){"use strict";n.a="\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n"},NEgR:function(e,n,t){"use strict";function r(){var e=F.get("cm");return _(e)?e:I.colorMode}function o(e){_(e)&&(F.set({cm:e}),D.cm=e)}function i(){var e=F.get("fo");return _(e)?e:I.fadeout}function a(e){_(e)&&(F.set({fo:e}),D.fo=e)}function u(){var e=F.get("pc");return _(e)?e:I.particleCount}function c(e){_(e)&&(F.set({pc:e}),D.pc=e)}function s(){var e=F.get("dt");return _(e)?e:I.timeStep}function f(e){_(e)&&(F.set({dt:e}),D.dt=e)}function d(){var e=F.get("dp");return _(e)?e:I.dropProbability}function l(e){_(e)&&(b(e,0,1),F.set({dp:e}))}function p(){var e=F.get("cx"),n=F.get("cy"),t=F.get("w"),r=F.get("h");if(_(e)&&_(n)&&_(t)&&_(r)){var o=t/2,i=r/2,a=1e4;return{minX:Math.round(a*(e-o))/a,maxX:Math.round(a*(e+o))/a,minY:Math.round(a*(n-i))/a,maxY:Math.round(a*(n+i))/a}}}function v(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y&&(clearTimeout(y),y=0),n?m(e):y=setTimeout(function(){return m(e)},300)}function m(e){y=0;var e={cx:.5*(e.minX+e.maxX),cy:.5*(e.minY+e.maxY),w:e.maxX-e.minX,h:e.maxX-e.minX};e.w<=0||e.h<=0||(F.set(e),D.cx=e.cx,D.cy=e.cy,D.w=e.w,D.h=e.h)}function g(){var e=F.get("vf");if(e)return e;var n=F.get("code");return n?(e=t.i(M.a)(n),delete D.code,F.set("vf",e),e):S}function x(){return S}function h(e){F.set({vf:e}),D.code=e}function _(e){return E()(e)}function b(e,n,t){return e<n?n:e>t?t:e}var y,w=t("AMV0"),E=t.n(w),T=t("7UaU"),P=t.n(T),A=t("eBcr"),R=t.n(A),C=t("6c6E"),M=t("cj2E"),F=P()({},{useSearch:!0,rewriteHashToSearch:!0}),D=F.get(),S=t.i(M.a)("v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;"),I={timeStep:.01,dropProbability:.009,particleCount:1e4,fadeout:.998,colorMode:C.a.UNIFORM},X={collapsed:window.innerWidth<600};n.a={settingsPanel:X,saveBBox:v,getBBox:p,getQS:function(){return F},saveCode:h,getCode:g,getDefaultCode:x,getDropProbability:d,setDropProbability:l,getIntegrationTimeStep:s,setIntegrationTimeStep:f,getParticleCount:u,setParticleCount:c,getFadeout:i,setFadeout:a,getColorMode:r,setColorMode:o},F.onChange(function(){R.a.fire("scene-ready",window.scene)})},Qv35:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("zwoO"),a=t.n(i),u=t("Pf15"),c=t.n(u),s=t("Zrlr"),f=t.n(s),d=t("wxAW"),l=t.n(d),p=t("4KA4"),v=t("XMEc"),m=t("S+/9"),g=t("DuZ1"),x=t("vhRe"),h=t("i69e"),_=function(){function e(n){f()(this,e),this.readStoredPosition=new v.a(!0),this.udfVelocity=new g.a,this.integratePositions=new h.a,this.dropParticles=new b,this.writeComputedPosition=new v.a(!1),this.panZoomDecode=new x.a({decode:!0}),this.panZoomEncode=new x.a({decode:!1}),this.colorMode=n&&n.colorMode}return l()(e,[{key:"setCustomVectorField",value:function(e){this.udfVelocity.setNewUpdateCode(e)}},{key:"getVertexShader",value:function(){return"precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}"}},{key:"getFragmentShader",value:function(){var e=[this.readStoredPosition,this.dropParticles,this.udfVelocity,this.integratePositions,{getMainBody:function(){return"\n  vec2 newPos = pos + velocity;\n  "}},this.writeComputedPosition];return t.i(m.a)(e)}}]),e}();n.a=_;var b=function(e){function n(){return f()(this,n),a()(this,(n.__proto__||o()(n)).apply(this,arguments))}return c()(n,e),l()(n,[{key:"getDefines",value:function(){return"\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n"}},{key:"getFunctions",value:function(){return"\n// pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n"}},{key:"getMainBody",value:function(){return"\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n"}}]),n}(p.a)},"S+/9":function(e,n,t){"use strict";function r(e){function n(e){e&&t.push(e)}var t=[];return e.forEach(function(e){e.getDefines&&n(e.getDefines())}),e.forEach(function(e){e.getFunctions&&n(e.getFunctions())}),n("void main() {"),e.forEach(function(e){e.getMainBody&&n(e.getMainBody())}),n("}"),t.join("\n")}n.a=r},V39N:function(e,n,t){"use strict";function r(){function e(){n=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY}var n,t;return{getMin:function(){return n},getMax:function(){return t},add:function(e){e<n&&(n=e),e>t&&(t=e)},reset:e}}n.a=r},XFig:function(e,n,t){"use strict";n.a="\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n"},XMEc:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),u=t("wxAW"),c=t.n(u),s=t("zwoO"),f=t.n(s),d=t("Pf15"),l=t.n(d),p=t("4KA4"),v=t("a8s+"),m=t("XFig"),g=function(e){function n(e){a()(this,n);var t=f()(this,(n.__proto__||o()(n)).call(this));return t.isDecode=e,t}return l()(n,e),c()(n,[{key:"getFunctions",value:function(){if(this.isDecode)return"\n    "+v.a+"\n    "+m.a+"\n"}},{key:"getDefines",value:function(){if(this.isDecode)return"\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n"}},{key:"getMainBody",value:function(){return this.isDecode?"\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n":"\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n"}}]),n}(p.a);n.a=g},YJWA:function(e,n,t){"use strict";function r(e){if(!f)return void t.e(1).then(function(){f=t("nI+d"),window.stopRecord=i,r(e)}.bind(null,t)).catch(t.oe);if(d&&d.stop(),!o()){var n=document.createElement("script");return n.setAttribute("src",e||"http://localhost:8080/ffmpegserver/ffmpegserver.js"),n.onload=function(){return r(e)},void document.head.appendChild(n)}d=new f({format:"ffmpegserver",framerate:60,verbose:!0,name:"fieldplay",extension:".mp4",codec:"mpeg4",ffmpegArguments:["-b:v","12M"]}),window.isRecording=!0,d.start(),c.a.fire("start-record",d)}function o(){return"undefined"!=typeof FFMpegServer}function i(){window.isRecording=!1,c.a.fire("stop-record",d),d.stop(),d.save()}Object.defineProperty(n,"__esModule",{value:!0});var a=t("JHsM"),u=t("eBcr"),c=t.n(u),s=document.getElementById("scene");s&&function(e){e.width=window.innerWidth,e.height=window.innerHeight;var n={antialiasing:!1},r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);if(r){window.webGLEnabled=!0;var o=t.i(a.a)(r);o.start(),window.scene=o}else window.webGLEnabled=!1}(s),t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var f,d;window.startRecord=r,window.isRecording=!1},"a8s+":function(e,n,t){"use strict";n.a="\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n"},aZPT:function(e,n,t){"use strict";function r(e,n){e.getMethods&&n.push(e.getMethods())}function o(e,n){e.getMain&&n.push(e.getMain())}function i(){return{getVariables:function(){},getMain:function(){}}}function a(){function e(){return"\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    "}function n(){return"\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n"}return{getVariables:e,getMain:n}}var u=t("Zrlr"),c=t.n(u),s=t("wxAW"),f=t.n(s),d=t("XFig"),l=t("c5NW"),p=t("6c6E"),v=function(){function e(n){c()(this,e),this.colorMode=n,this.isUniformColor=n===p.a.UNIFORM}return f()(e,[{key:"getFragmentShader",value:function(){var e=[],n=[];return this.isUniformColor?(e.push("uniform vec4 u_particle_color;"),n.push("gl_FragColor = u_particle_color;")):(e.push("varying vec4 v_particle_color;"),n.push("gl_FragColor = v_particle_color;")),"precision highp float;\n"+e.join("\n")+"\n\nvoid main() {\n"+n.join("\n")+"\n}"}},{key:"getVertexShader",value:function(e){var n=a(),u=this.isUniformColor?i():t.i(l.a)(this.colorMode,e),c=[];r(n,c),r(u,c);var s=[];return o(n,s),o(u,s),"precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n"+(n.getVariables()||"")+"\n"+(u.getVariables()||"")+"\n\n"+d.a+"\n\n"+c.join("\n")+"\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n"+s.join("\n")+"\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}"}}]),e}();n.a=v},bvb0:function(e,n,t){"use strict";function r(){return"uniform sampler2D input0;\nuniform sampler2D input1;"}n.a=r},c5NW:function(e,n,t){"use strict";function r(e,n){function t(){return"\nuniform vec2 u_velocity_range;\nvarying vec4 v_particle_color;\n"+c.getDefines()+"\n"+s.getDefines()+"\n"}function r(){return"\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n"+c.getFunctions()+"\n"+s.getFunctions()+"\n"}function u(){return"\nvec2 velocity = get_velocity(v_particle_pos);\n"+(e===a.a.VELOCITY?"\n  float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n  v_particle_color = vec4(hsv2rgb(vec3(0.05 + (1. - speed) * 0.5, 0.9, 1.)), 1.0);\n":"\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  v_particle_color = vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n")+"\n"}var c=new o.a(n),s=new i.a;return{getVariables:t,getMain:u,getMethods:r}}n.a=r;var o=t("DuZ1"),i=t("i69e"),a=t("6c6E")},c5hq:function(e,n,t){"use strict";function r(e){function n(){i.a.off("glsl-parser-ready",s)}function r(){return a.a.getCode()}function o(e){if(e===p)return void(d&&d.error&&s());f(e).then(function(n){if(!n.cancelled){if(n&&n.error)return c(n.error),n;p=e,v.code=e,a.a.saveCode(e)}})}function c(e){e&&e.error?(v.error=e.error,v.errorDetail=e.errorDetail,v.isFloatError=e.isFloatError):(v.error="",v.errorDetail="",v.isFloatError=!1)}function s(e){return t.i(u.a)(e||p).then(function(e){return d=e,c(d.error),d})}function f(n){l+=1;var t=l;return s(n).then(function(n){if(t!==l)return n.cancelled=!0,n;if(n.error)return n;try{return e.updateCode(n.code),n}catch(e){return{error:{error:e.message}}}})}i.a.on("glsl-parser-ready",s);var d,l=0,p=a.a.getCode();!function(){var e=a.a.getCode();e?f(e).then(function(e){e.error&&(console.error("Failed to restore previous vector field: ",e.error),f(a.a.getDefaultCode()))}):f(a.a.getDefaultCode())}();var v={getCode:r,setCode:o,dispose:n,code:p,error:"",errorDetail:"",isFloatError:!1};return v}n.a=r;var o=t("eBcr"),i=t.n(o),a=t("NEgR"),u=t("85ps")},cj2E:function(e,n,t){"use strict";function r(e){return"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  "+e+"\n\n  return v;\n}"}n.a=r},eBcr:function(e,n,t){var r=t("puH/");e.exports=r({})},egvE:function(e,n,t){"use strict";function r(e,n){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);var r=e.RGBA,i=e.RGBA,a=e.UNSIGNED_BYTE,u=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,0,r,1,1,0,i,a,u);var c=new Image;return c.crossOrigin="",c.onload=function(){e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,r,i,a,c),o(c.width)&&o(c.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))},c.src=n,t}function o(e){return 0==(e&e-1)}n.a=r},fkI9:function(e,n){function t(e){var n=Object.create(null);return{on:function(t,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=n[t];return i||(i=n[t]=[]),i.push({callback:r,ctx:o}),e},off:function(t,r){if(void 0===t)return n=Object.create(null),e;if(n[t]){if("function"!=typeof r)delete n[t];else for(var o=n[t],i=0;i<o.length;++i)o[i].callback===r&&o.splice(i,1)}return e},fire:function(t){var r=n[t];if(!r)return e;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var a=r[i];a.callback.apply(a.ctx,o)}return e}}}function r(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],t=0;t<n.length;++t)if(e.hasOwnProperty(n[t]))throw new Error("Subject cannot be eventified, since it already has property '"+n[t]+"'")}e.exports=function(e){r(e);var n=t(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e}},gIFv:function(e,n,t){"use strict";function r(e){function n(){u.a.off("integration-timestep-changed",a),u.a.off("bbox-change",a),r()}function r(){x&&T.deleteTexture(x),g&&T.deleteTexture(g)}function a(){_&&clearTimeout(_),_=setTimeout(function(){E=!0,_=0},50)}function c(e){T.uniform2f(e.u_velocity_range,P.getMin(),P.getMax())}function l(){r(),h=e.particleStateResolution,b=h*h,y=new Uint8Array(4*b),w=new Uint8Array(4*b),x=i.a.createTexture(T,T.NEAREST,y,h,h),g=i.a.createTexture(T,T.NEAREST,w,h,h),a()}function p(){a()}function v(n){E&&y&&w&&(E=!1,i.a.bindFramebuffer(T,e.framebuffer,x),T.uniform1i(n.u_out_coordinate,f),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,h,h,T.RGBA,T.UNSIGNED_BYTE,y),i.a.bindFramebuffer(T,e.framebuffer,g),T.uniform1i(n.u_out_coordinate,d),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,h,h,T.RGBA,T.UNSIGNED_BYTE,w),m())}function m(){P.reset();for(var e=0;e<w.length;e+=4){var n=o(y,e),t=o(w,e),r=Math.sqrt(n*n+t*t);P.add(r)}}var g,x,h,_,b,y,w,E=!0,T=e.gl,P=t.i(s.a)();return function(){u.a.on("integration-timestep-changed",a),u.a.on("bbox-change",a)}(),{updateCode:p,updateParticlesPositions:v,updateParticlesCount:l,setColorMinMax:c,requestSpeedUpdate:a,dispose:n}}function o(e,n){return t.i(c.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var i=t("Ddjs"),a=t("eBcr"),u=t.n(a),c=t("FaU1"),s=t("V39N"),f=6,d=7},h62Y:function(e,n,t){"use strict";function r(e){function n(){o.a.bindFramebuffer(f,e.framebuffer,c),f.viewport(0,0,d.width,d.height),g.boundingBoxUpdated&&p?(l.dx=-(e.bbox.minX-p.minX)/(e.bbox.maxX-e.bbox.minX),l.dy=-(e.bbox.minY-p.minY)/(e.bbox.maxY-e.bbox.minY),l.scale=(e.bbox.maxX-e.bbox.minX)/(p.maxX-p.minX),u(s,e.fadeOpacity,l)):u(s,e.fadeOpacity,i)}function t(){o.a.bindFramebuffer(f,null),a(),f.enable(f.BLEND),f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA),f.clearColor(v.r,v.g,v.b,v.a),f.clear(f.COLOR_BUFFER_BIT),u(c,1,i),f.disable(f.BLEND);var e=s;s=c,c=e,g.boundingBoxUpdated=!1,window.audioTexture&&u(window.audioTexture,1,i)}function r(){var e=d.width,n=d.height,t=new Uint8Array(e*n*4);c&&f.deleteTexture(c),s&&f.deleteTexture(s),c=o.a.createTexture(f,f.NEAREST,t,e,n),s=o.a.createTexture(f,f.NEAREST,t,e,n)}function a(){if(!p)return void(p={minX:e.bbox.minX,minY:e.bbox.minY,maxX:e.bbox.maxX,maxY:e.bbox.maxY});p.minX=e.bbox.minX,p.minY=e.bbox.minY,p.maxX=e.bbox.maxX,p.maxY=e.bbox.maxY}function u(n,t,r){var i=m;f.useProgram(i.program),o.a.bindAttribute(f,e.quadBuffer,i.a_pos,2),o.a.bindTexture(f,n,e.screenTextureUnit),f.uniform1i(i.u_screen,e.screenTextureUnit),f.uniform1f(i.u_opacity_border,.02),f.uniform1f(i.u_opacity,t),f.uniform3f(i.u_transform,r.dx,r.dy,r.scale),f.drawArrays(f.TRIANGLES,0,6)}var c,s,f=e.gl,d=e.canvasRect,l={dx:0,dy:0,scale:1},p=null,v={r:19/255,g:41/255,b:79/255,a:1};r();var m=o.a.createProgram(f,"// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}","precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  // For some reason particles near border leave trace when we translate the texture\n  // This is my dirty hack to fix it: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n  if (p.x < u_opacity_border || p.x > 1. - u_opacity_border || p.y < u_opacity_border || p.y > 1. - u_opacity_border) {\n    gl_FragColor = vec4(0.);\n  } else {\n    // opacity fade out even with a value close to 0.0\n    gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n  }\n}"),g={fadeOutLastFrame:n,renderCurrentScreen:t,updateScreenTextures:r,boundingBoxUpdated:!1};return g}n.a=r;var o=t("Ddjs"),i={dx:0,dy:0,scale:1}},i69e:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),u=t("wxAW"),c=t.n(u),s=t("zwoO"),f=t.n(s),d=t("Pf15"),l=t.n(d),p=t("4KA4"),v=function(e){function n(){return a()(this,n),f()(this,(n.__proto__||o()(n)).call(this))}return l()(n,e),c()(n,[{key:"getDefines",value:function(){return"\nuniform float u_h;\n"}},{key:"getFunctions",value:function(){return"\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}"}},{key:"getMainBody",value:function(){return"\n  vec2 velocity = rk4(pos);\n"}}]),n}(p.a);n.a=v},iw7m:function(e,n,t){"use strict";function r(e){if(!e)return i.a.reject("Missing link");var n=e.trim();if(!n)return i.a.reject("Missing link");var r=s.get(n);return r?i.a.resolve(r):t.i(c.a)(e).then(function(n){return s.set(e,n),n})}n.a=r;var o=t("//Fk"),i=t.n(o),a=t("ifoU"),u=t.n(a),c=t("C8nW"),s=new u.a},n67P:function(e,n,t){"use strict";function r(){function e(e,n){var t=o.get(e);t&&t.dispose(),o.set(e,n)}function n(e){r=e,o.forEach(t)}function t(e,n){e.updateBinding(r,n)}var r,o=new i.a;return{updateBindings:n,bindInput:e}}n.a=r;var o=t("ifoU"),i=t.n(o)},p0IO:function(e,n,t){"use strict";function r(e,n){var t=0,r=0,o=1;return{applyTransform:function(e){var i=e.x,a=e.y;0==o-e.scale&&Math.abs(i-t)<2.1&&Math.abs(a-r)<2.1||(t=i,r=a,o=e.scale,n(e))},getOwner:function(){return e}}}n.a=r},p2DF:function(e,n,t){"use strict";t("rvz5"),t("Ddjs")},p9aJ:function(e,n,t){"use strict";function r(e){function n(){window.removeEventListener("mousemove",o,!0),window.removeEventListener("mousedown",i,!0),window.removeEventListener("touchstart",t,!0),window.removeEventListener("touchmove",r,!0)}function t(e){var n=e.touches[0];n&&(u(n.clientX,n.clientY),a(n.clientX,n.clientY))}function r(e){var n=e.touches[0];n&&a(n.clientX,n.clientY)}function o(e){a(e.clientX,e.clientY)}function i(e){u(e.clientX,e.clientY)}function a(n,t){e.cursor.hoverX=c(n),e.cursor.hoverY=s(t)}function u(n,t){e.cursor.clickX=c(n),e.cursor.clickY=s(t)}function c(e){var n=(e-f.left)/f.width;return(d.maxX-d.minX)*n+d.minX}function s(e){var n=1-(e-f.top)/f.height;return(d.minY-d.maxY)*n+d.maxY}var f=e.canvasRect,d=e.bbox;return window.addEventListener("mousemove",o,!0),window.addEventListener("mousedown",i,!0),window.addEventListener("touchstart",t,!0),window.addEventListener("touchmove",r,!0),{dispose:n}}n.a=r},pKWO:function(e,n,t){"use strict";function r(e){function n(){h&&h.unload();var n=new i.a(e.colorMode);h=o.a.createProgram(_,n.getVertexShader(b),n.getFragmentShader())}function r(){b&&(e.frame+=1,e.frameSeed=Math.random(),x&&x.updateTextures(),y.updateParticlesPositions())}function f(){n()}function d(t){e.frame=0,b=t,y.updateCode(t),n()}function l(){v=e.particleStateResolution,g=v*v;for(var n=new Float32Array(g),r=new Uint8Array(4*g),i=new Uint8Array(4*g),a=e.bbox.minX,c=e.bbox.minY,s=e.bbox.maxX-a,f=e.bbox.maxY-c,d=0;d<g;d++)t.i(u.a)(Math.random()*s+a,r,4*d),t.i(u.a)(Math.random()*f+c,i,4*d),n[d]=d;m&&_.deleteBuffer(m),m=o.a.createBuffer(_,n),y.updateParticlesCount(r,i)}function p(){if(b){var n=h;_.useProgram(n.program),o.a.bindAttribute(_,m,n.a_index,1),y.prepareToDraw(n),e.inputs.updateBindings(n),_.uniform1f(n.u_h,e.integrationTimeStep),_.uniform1f(n.frame,e.frame),_.uniform1f(n.u_particles_res,v);var t=e.bbox;_.uniform2f(n.u_min,t.minX,t.minY),_.uniform2f(n.u_max,t.maxX,t.maxY);var r=e.cursor;_.uniform4f(n.cursor,r.clickX,r.clickY,r.hoverX,r.hoverY),_.drawArrays(_.POINTS,0,g)}}var v,m,g,x,h,_=e.gl,b="",y=t.i(a.a)(e);return function(){n(),c.a.isAudioEnabled&&(x&&x.dispose(),x=t.i(s.a)(e))}(),{updateParticlesCount:l,updateParticlesPositions:r,drawParticles:p,updateCode:d,updateColorMode:f}}n.a=r;var o=t("Ddjs"),i=t("aZPT"),a=t("3xg8"),u=t("FaU1"),c=t("rvz5"),s=t("94y8")},pXNl:function(e,n,t){"use strict";function r(e,n,t){function r(n){u.forEach(function(t){e.uniform1i(n["u_particles_"+t.name],t.index)})}function i(){u.forEach(function(n){return e.deleteTexture(n.texture)})}function a(e,n){u.forEach(function(t){o.a.bindTexture(e,t.texture,t.index),e.uniform1i(n["u_particles_"+t.name],t.index)})}var u=n.map(function(n,r){return{texture:o.a.createTexture(e,e.NEAREST,n.particleState,t,t),index:r,name:n.name}});return{dispose:i,bindTextures:a,assignProgramUniforms:r,length:n.length,textures:u,get:function(e){return u[e]}}}n.a=r;var o=t("Ddjs")},rvz5:function(e,n,t){"use strict";var r=t("NEgR"),o={isAudioEnabled:!1,vectorLinesEnabled:!1,FREE_TEXTURE_UNIT:4,showBindings:r.a.getQS().get("showBindings")||!1};n.a=o},svlg:function(e,n,t){"use strict";function r(e){if(!e)return new a.a(function(e){return e(s)});var n=o(e);return n.pending.length>0?a.a.all(n.pending).then(function(){return n}).catch(function(e){return{error:{error:e}}}):new a.a(function(e){return e(n)})}function o(e){function n(){return a.join("\n")}function r(e){if(0===e.indexOf(c)){var n=e.substr(c.length),r=s;o.push(t.i(u.a)(n).then(function(e){a[r]=e}))}}var o=[],i=e.split("\n"),a=[],s=0;return i.forEach(function(e,n){s=n,e&&"#"===e[0]?(a.push(""),r(e)):a.push(e)}),{getCode:n,pending:o}}n.a=r;var i=t("//Fk"),a=t.n(i),u=t("iw7m"),c="#include ",s={code:""}},vhRe:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),u=t("wxAW"),c=t.n(u),s=t("zwoO"),f=t.n(s),d=t("Pf15"),l=t.n(d),p=t("4KA4"),v=function(e){function n(e){a()(this,n);var t=f()(this,(n.__proto__||o()(n)).call(this));return t.decode=e&&e.decode,t.srcPosName=e&&e.posName||"pos",t}return l()(n,e),c()(n,[{key:"getDefines",value:function(){if(this.decode)return"\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n"}},{key:"getMainBody",value:function(){return this.decode?"\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = "+this.srcPosName+".x * du.x + u_min.x;\n  pos.y = "+this.srcPosName+".y * du.y + u_min.y;\n":"\n  pos.x = ("+this.srcPosName+".x - u_min.x)/du.x;\n  pos.y = ("+this.srcPosName+".y - u_min.y)/du.y;\n"}}]),n}(p.a);n.a=v}},["YJWA"]);
//# sourceMappingURL=app.13a27ac96ad5275845a4.js.map